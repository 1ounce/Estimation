
<!--------Start of stone chage model-->
 <!------START OF MAKING CHARGE MODAL------>
 <ng-template #template2  id="side-modal" style="padding:10px;margin-top:20px">
    <div class="side-modal">
      <div class="modal-header ">
      <h4 class="modal-title ">Addon Charges</h4>
      <button type="button" display="inline" class="close pull-right" aria-label="Close" (click)="makingChargeModal.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
        
        
      </div>
      <div class="modal-body">
      <h5>Making Charges</h5>
        <table style="width:100%" border="2" class="table-responsive"> 
        <tr>
        <th width=20px>S.no</th>
        <th>Name</th>
        <th>Weight/pieces</th>
        <th>Cost/[gm|piece]</th>
        <th>Total</th>
        </tr>
    
        <!----- Making charge display section starts here -->
        <tr  style="width:10px;" *ngFor="let i of selectedItem.makingChargeItems;let sno=index;">
    
        <td>{{sno+1}}</td>
        <td>{{i.name}}</td>
        <td>{{i.weight}}</td>
        <td>{{money(i.cost)}}</td>
        <td>{{money(i.total)}}</td>
    
        </tr>
        <!-----Making charge display section ends here  -->
    
    
       
        <!---Stone making charge Input Section ends here--> 
    
    
              <tr>
                <!-- <td colspan="3"></td> -->
              
                <td>Sub Total:</td>
                <td >{{money(selectedItem.makingCharge)}}</td>
            
              </tr>
        
          </table >
          <br>
          <br>
          <h5>Stone Charges</h5>
    
         <table style="width:100%" border="2" class="table-responsive">
        <tr>
        <th width=20px>S.no</th>
        <th>Name</th>
        <th>Weight/pieces</th>
        <th>Cost/[gm|piece]</th>
        <th>Total</th>
          <hr align="right">
        </tr>
    
        <!----- Making charge display section starts here -->
        <tr  style="width:10px;" *ngFor="let i of selectedItem.stones;let sno=index;">
    
        <td>{{sno+1}}</td>
        <td>{{i.name}}</td>
        <td>{{i.weight}}</td>
        <td>{{money(i.cost)}}</td>
        <td>{{money(i.total)}}</td>
    
        </tr>
        <!-----Making charge display section ends here  -->
    
       
       
        <!---Stone making charge Input Section ends here--> 
    
    
              <tr>
                <td></td>
                <td></td>
                <td></td>
                <td>Sub Total:</td>
                <td>{{money(selectedItem.stoneCharge)}}</td>
             
              </tr>
        
          </table>
        </div>
      </div>
    </ng-template>
    <!------End of stone charge modal-->
    
    <!---START OF CONTACTS--->
    <ng-template #contactsTemplate>
      <div class="side-modal">
        <div class="modal-header ">
         <h4 class="modal-title ">Contacts</h4>
        <button type="button" display="inline" class="close pull-right" aria-label="Close" (click)="contactsModal.hide()">
            <span aria-hidden="true">&times;</span>
          </button>
         
          
        </div>
        <div class="modal-body">
          <table style="width:100%;" class="table-responsive">
              <tr>
                <td>      
                  <mat-form-field>
                    <input matInput type="text" placeholder="Name" [(ngModel)]="contact.name">
                  </mat-form-field>
               </td>
                <td>
                  <mat-form-field>
                    <input matInput  type="number" placeholder="Phone" [(ngModel)]="contact.phone">
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <mat-form-field>
                    <input matInput type='email' placeholder="Email" [(ngModel)]="contact.email">
                  </mat-form-field>
                </td>
                <td>
                  <button mat-raised-button color='primary' (click)="saveContact()">Add Contact</button>
                </td>
              </tr>
    
    
          </table>
    
          <br>
          <hr>
         <ng-container *ngIf="contacts!=null">
          <mat-list>
            
            <mat-list-item *ngFor="let contact of contacts" style="margin-bottom:13px;" class="contactList" (click)="onContactClicked(contact)" >
                <div [className]="color.getColor()" >
                  <div class="circleAlphabet">
                    {{ contact.name[0]}}
                  </div>
                </div>
                <span>
                  <b>{{contact.name}}</b>
                  <br>
                  {{contact.phone}}
                  </span>
              
        
            </mat-list-item>
          </mat-list>
         </ng-container>
         
         <ng-container *ngIf="contacts==null">
           No Contacts Available
         </ng-container>
    
        </div>
    
      </div>
    
    </ng-template>
    
    <!---END OF CONTACTS--->
    
    





<div class="container-fluid">
    <div class="row" *ngIf='selected!= null'>
        <div class="col-md-6">
            <table style="width:100%" class="table-responsive">
                <tr><td>Name:</td><th>{{selected.customer}}</th></tr>
                <tr><td>Address:</td><th *ngIf ='selected.address!=null'>{{selected.address}}</th></tr>
            </table>
        </div>
        <div class="col-md-6">
            <table style="width:100%" class="table-responsive">
            <tr><td>Phone:</td><th *ngIf ='selected.phone!=null'>{{selected.phone}}</th></tr>
            <tr><td>Date:</td><th >{{selected.getDate()}}</th></tr>
        </table>
        </div>
    </div>
<hr>
    <div class="row table-responsive" *ngIf= 'selected != null'>
        <table style="width:100%" border="1" class="">
            <tr >
                  
                  <th>S no.</th>
                  <th>Due date</th>
                  <th>Assigned To</th>
                  <th>Image</th>
                  <th>Description</th>
                  <th>Weight</th>
                  <th>Wastage %</th>
                  <th>MC</th>
                  <th>Stone Charge</th>
                  <th>Total</th>
                  <th>Status</th>
     
                  
                  </tr>
     
             <tr style="padding:10px;margin-top:40px;"  *ngFor="let item of selected.items;let i =index" >
                  
     
                  <td >
                     <b> {{i+1}}</b>
                  </td>
                  <td *ngIf="item.due==null"> --- </td>
                  <td *ngIf="item.due!=null">{{ item.due.slice(0,item.due.indexOf('T')) }}</td>
                  <td *ngIf="item.assignedTo!=null" (click)="openSelectOrAddContacts(item,contactsTemplate)" style="cursor:pointer;">{{item.assignedTo.name}}</td>
                  <td *ngIf="item.assignedTo==null" (click)="openSelectOrAddContacts(item,contactsTemplate)"><button mat-button-raised>+</button></td>
                  <!--Related to image set-->
                  <td *ngIf="item.isImageSet()"><img [src]="getselectedIamge(item)" height="150px" width="250px" style="object-fit: contain;padding: 5px;"></td>  
                  <td *ngIf="!item.isImageSet()">     
                       <!--  <span style="color:red;" *ngIf="item.imageUploader.message">{{item.imageUploader.message}}</span> -->
                     <input #file type="file" accept='image/*' (change)="item.imageUploader.preview(file.files);uploadItemImage(item);" />
                     <!-- <input  type="file" accept='image/*' (change)="uploadItemImage($event,selected.id)" /> -->
                     <!-- <img [src]="selectedimage" height="60%" width="100%" *ngIf="selectedimage"> -->
                     <!-- <img *ngIf="selectedimage" [src]="selectedimage" height="50%" width="80%" class="img-thumbnail"> -->
                     {{item.imageUploader.imgURL}}
                   </td>
                  <!-- End of item related image  -->
                  <td>{{item.name}}</td>
                  <td>{{item.weight}}</td>
                  <td>{{item.wastage}}</td>
                 <td >{{money(item.makingCharge)}}<mat-icon style="font-size:12px;color:green;cursor:pointer;" (click)="openSelectedMakingChargeModal(item,template2,true)"  >info_outline</mat-icon></td>
                 <td >{{money(item.stoneCharge)}}<mat-icon style="font-size:12px;color:green;cursor:pointer;" (click)="openSelectedMakingChargeModal(item,template2,false)"  >info_outline</mat-icon></td> 
                  <td>{{money(item.total)}}</td>
                   <td>
                     <p *ngIf="item.status==0"><mat-icon style="color:red">info</mat-icon>Pending</p>
                     <p *ngIf="item.status==1"><mat-icon style="color:blue">how_to_reg</mat-icon>Assigned</p>
                     <p *ngIf="item.status==2"><mat-icon style="color:green">check_circle_outline</mat-icon>Completed</p>
                   </td>
                  
                  </tr >   
                 
                  <tr style="margin-top:30px;">
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>SubTotal</td>
                  <td>{{money(selected.item_subtotal)}}</td>
                  </tr>    
         </table>
         
    </div>

    <div class="row" style="margin-top: 20px;">
      <!-- Old Gold details -->
      <div class="col-md-6 table-responsive" *ngIf= 'selected != null'>
        <h4>Old Gold</h4>
        <table style="width:100%" border="1" >
          <tr >
                
                <th>S no.</th>
                <th>Description</th>
                <th>Dust</th>
                <th>Weight</th>
                <th>Purity</th>
                <th>Rate</th>
                <th>Total</th>
                
   
                
                </tr>
                <tr style="padding:10px;margin-top:40px;"  *ngFor="let item of selected.oldGold;let i =index" >
                  
     
                  <td >
                     <b> {{i+1}}</b>
                  </td>
                  <td>{{item.description}}</td>
                  <td>{{item.dust}}</td>
                  <td>{{item.weight}}</td>
                  <td>{{item.purity}}</td>
                  <td>{{item.rate}}</td>
                  <td>{{item.total}}</td>
                  </tr>
            </table>
      </div> 
      <!-- old gold detail ends -->
      <div class="col-md-6 table-responsive" *ngIf= 'selected != null'>
        <!-- Advance details -->
        <h4>Advances</h4>
        <table style="width:100%" border="1" >
          <tr >
                
                <th>S no.</th>
                <th>RefrenceId</th>
                <th>Mode</th>
                <th>Amount</th>
              
            </tr>
            <tr style="padding:10px;margin-top:40px;"  *ngFor="let item of selected.advances;let i =index" >
                  
     
              <td >
                 <b> {{i+1}}</b>
              </td>
              <td>{{item.ref_id}}</td>
              <td>
                <p *ngIf="item.type==0">Cash</p>
                <p *ngIf="item.type==1">Card</p>
                <p *ngIf="item.type==2">Cheque</p>
                <p *ngIf="item.type==3">Phone Pay</p>
                <p *ngIf="item.type==4">Paytam</p>
                <p *ngIf="item.type==5">Google Pay</p>
                <p *ngIf="item.type==6">Other</p>

              </td>
              <td>{{item.amount}}</td>
              
              </tr>
              <tr style="margin-top:30px;">
                <td></td>
                <td></td>
                <td>Total</td>
                <td>{{money(selected.advance_subtotal)}}</td>
                </tr> 
        </table>
      </div>
    </div>
<div class="row">
  <div class="col-md-6" style="margin-top: 20px;">
    <button mat-raised-button color="primary" align="left" (click)="backClicked()">Back</button>
  </div>
  <div class="col-md-6" style="margin-top: 20px;"> 
    
      <button mat-raised-button class="backBtn" color="primary" (click)="print()" align=right>print</button>

  </div>
</div>
    <!-- end of container class -->


<div id="print-section">
  <div class="print" *ngIf="selected != null">
          <table>
            <tr>
             
              <td align="left" style="line-height: 0px;">
                <h3>Company Name</h3> 
                <p style="color: rgb(204, 104, 104);">GstNo:12457847576</p>
                <p>4th Block Koramangla Banglore</p>
                <p>560074</p>
                <p>PhoneNo:9874665744</p>
                
              </td>
               <td align="right" ><p style="margin-left: 200px;"><img class="img-responsive" src="assets/images/logo2.png" style="width: 150px;height:100px;object-fit: contain;padding-left: 60px;"></p></td>
            </tr>
          </table>
          <!-- for the customer info section -->
        
         <table bgcolor="#d6d5d4" width="100%" align="center" cellpadding="0" cellspacing="0">
           <tr>
             <td align="left" style="padding-left: 10px;">
               <table style="margin-left: 10px;">
                 <tr>
                   <td>{{selected.customer}}</td>
                 </tr>
                 <tr>
                  <td>{{selected.address}}</td>
                </tr>
                <tr>
                  <td>{{selected.phone}}</td>
                </tr>
               </table>

             </td>
             <td align="right" style="padding-right: 80px;" *ngIf="selected!=null">
              <table>
                <tr>
                  <td><p><b>INVOICE</b></p></td>
                </tr>
                <tr>
                 <td>OrderId: {{id}}</td>
               </tr>
               <tr>
                 <td>Order Date: {{selected.date}}</td>
               </tr>
              </table>
             </td>
           </tr>
         </table>
          <!-- end of customer info -->
<!-- items related code -->
<table  width="90%" align="center" cellpadding="0" border="1"  cellspacing="0" style="margin:20px;">
           <tr>
            <th>Sno</th>
             <th>Descrption</th>
             <th>Quantity</th>
             <th>Rate</th>
             <th>Amount</th>
           </tr>
           <tr *ngFor="let item of selected.items;let i =index"  align="center">
            <td> <b> {{i+1}}</b></td>
            <td>{{item.name}}</td>
            <td>{{item.weight}}</td>
            <td>{{selected.rate}}</td>
            <td>{{item.total}}</td>
           </tr>
        
           <tr style="margin-top: 10px;" align="center" style="line-height: 20px;">
            
             
             <td colspan="4" align="right" >Gst <span>:</span></td>
             <td style="line-height: 10px;">{{selected.gst}}</td>
           </tr>
           <tr align="center">
            
            
            <td colspan="4" align="right">Total <span>:</span></td>
            <td><p style="color: cornflowerblue;">{{selected.total}}</p></td>
          </tr>
         </table>
<!-- items related code ends here -->
         <h5><u>OLD GOLD</u></h5>
         <table  width="90%" align="center" cellpadding="0" border="1" cellspacing="0" style="margin:20px;" class="table-responsive">
          <tr>
           <th>Sno</th>
            <th>Descrption</th>
            <th>Quantity</th>
            <th>Rate</th>
            <th style="min-width: 15px;">Amount</th>
          </tr>
          <tr *ngFor="let item of selected.oldGold;let i =index" align="center">
           <td> <b> {{i+1}}</b></td>
           <td>{{item.description}}</td>
           <td>{{item.weight}}</td>
           <td>{{item.rate}}</td>
           <td style="min-width: 15px;">{{item.total}}</td>
          </tr>
      
          
        </table>
        <table>
          <tr>
            <td align="right" style="min-width: 400px;">
              
            </td>
            <td align="right" style="min-width: 280px;">
              <table align="right" width="80%" border="1" style="border-collapse: collapse;">
                <tr align="left">
           
                  <td colspan="4" align="left">Total </td>
                  <td ><p style="color: cornflowerblue;">{{selected.total}}</p></td>
                </tr>
                <tr align="left">
                 
                  <td colspan="4" align="left">OldGold </td>
                  <td><p style="color: cornflowerblue;">{{selected.old_gold_subtotal}}</p></td>
                </tr>
                <tr align="left">
                 
                 <td colspan="4" align="left">Advance </td>
                 <td><p style="color: cornflowerblue;">{{selected.advance_subtotal}}</p></td>
               </tr>
               <tr align="left">
                
                 <td colspan="4" align="left">Balance </td>
                 <td ><p style="color: cornflowerblue;">{{(selected.balance)}}</p></td>
               </tr>
              </table>
            </td>
          </tr>
        </table>
        

    <p>**Subjected to gst Regulations**</p>

   <div style="margin-top: 100px;">
    <table width="90%" >
      <tr>
        <td align="left">
          <p>Customer Sign</p>
        </td>
        <td align="right">
          <p>For CompanyName</p>
        </td>
      </tr>
    </table>
   </div>
    <p><u><strong>KIND INFORMATION</strong></u></p>
    <p style="font-size: 11px;"> There will be variation of upto 20% on customer
      <br>specific(design&weight) order with sample <br>of gold & limitation Jwellery to be Made in Gold
    </p>
    <div style="margin-left: 5px;">
      <p style="font-size: 10px;">Note :-</p>
      <p style="font-size: 8;">1. price inclusive of hallmarking charges(HallMark charge Rs.35/pc) <br>
      2.The consumer can get the purity of the hallmarked Jwellery verified from any of the BIS recongnized A& h Center
    <br>3.The list of BIS recongnized A& H center along address and contact detalis is available on the website www.bis.gov.in</p>
    <p align="right" style="padding-right: 150px;font-size: 10px;"> E & OE</p>
    </div>
        

  </div>
</div>
<!-- End of print-Section -->


</div>